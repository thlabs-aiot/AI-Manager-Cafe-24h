<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Viewer - SVG & Markdown</title>
    
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js"></script>

    <style>
        /* CSS Reset cơ bản */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body, html { height: 100%; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }

        /* Layout chính: Chia đôi màn hình */
        .container {
            display: flex;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
        }

        /* Phần hiển thị SVG (Bên trái/Trên) */
        #svg-container {
            flex: 1; /* Chiếm 50% không gian */
            background-color: #f0f2f5;
            border-right: 1px solid #ddd;
            position: relative;
            overflow: hidden; /* Quan trọng để zoom không bị tràn */
        }

        /* SVG nhúng vào sẽ full màn hình chứa nó */
        #svg-content {
            width: 100%;
            height: 100%;
        }

        /* Phần hiển thị Markdown (Bên phải/Dưới) */
        #md-container {
            flex: 1; /* Chiếm 50% không gian */
            padding: 2rem;
            overflow-y: auto; /* Cho phép cuộn dọc nội dung text */
            background-color: #fff;
        }

        /* Style cho nội dung Markdown cho đẹp mắt (Typography) */
        .markdown-body {
            line-height: 1.6;
            color: #333;
        }
        .markdown-body h1, .markdown-body h2 { border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; margin-top: 24px; }
        .markdown-body code { background-color: #f6f8fa; padding: 0.2em 0.4em; border-radius: 3px; font-family: monospace; }
        .markdown-body table { border-collapse: collapse; width: 100%; margin: 15px 0; }
        .markdown-body th, .markdown-body td { border: 1px solid #dfe2e5; padding: 6px 13px; }
        .markdown-body img { max-width: 100%; }

        /* RESPONSIVE: Giao diện Mobile */
        @media (max-width: 768px) {
            .container {
                flex-direction: column; /* Xếp dọc thay vì ngang */
            }
            #svg-container {
                flex: none;
                height: 40vh; /* SVG chiếm 40% chiều cao màn hình */
                border-right: none;
                border-bottom: 1px solid #ddd;
            }
            #md-container {
                flex: 1; /* Markdown chiếm phần còn lại */
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <div id="svg-container">
            <object id="svg-object" type="image/svg+xml" style="width: 100%; height: 100%;"></object>
        </div>

        <div id="md-container">
            <div id="content" class="markdown-body">
                Đang tải dữ liệu...
            </div>
        </div>
    </div>

    <script>
        // CẤU HÌNH ĐƯỜNG DẪN FILE CỦA BẠN TẠI ĐÂY
        const CONFIG = {
            svgPath: './ban_ve.svg',  // Đường dẫn file SVG
            mdPath: './README.md'      // Đường dẫn file Markdown
        };

        // Hàm tải file text (Markdown)
        async function loadMarkdown() {
            try {
                const response = await fetch(CONFIG.mdPath);
                if (!response.ok) throw new Error("Không tìm thấy file MD");
                const text = await response.text();
                // Dùng marked để parse sang HTML
                document.getElementById('content').innerHTML = marked.parse(text);
            } catch (error) {
                // Nếu lỗi (hoặc chạy local không có server), hiển thị nội dung mẫu
                document.getElementById('content').innerHTML = `
                    <h1>Demo Chế độ xem</h1>
                    <p><i>Không tải được file .md (Lỗi: ${error.message}). Dưới đây là nội dung mẫu:</i></p>
                    <h2>Thông số kỹ thuật</h2>
                    <ul>
                        <li>Chipset: ESP32 / Jetson Nano</li>
                        <li>Giao thức: MQTT, HTTP</li>
                    </ul>
                    <p>Hãy đảm bảo bạn chạy file này qua Local Server (Live Server) để fetch được file.</p>
                `;
            }
        }

        // Hàm tải file SVG
        function loadSVG() {
            const svgObject = document.getElementById('svg-object');
            svgObject.setAttribute('data', CONFIG.svgPath);

            // Khi SVG tải xong thì kích hoạt thư viện Zoom
            svgObject.addEventListener('load', function() {
                // Chúng ta cần thao tác với DOM bên trong thẻ Object
                const svgDoc = svgObject.contentDocument; 
                const svgElement = svgDoc.documentElement; // Lấy thẻ <svg> gốc
                
                // Kích hoạt Pan/Zoom
                svgPanZoom(svgElement, {
                    viewportSelector: '.svg-pan-zoom_viewport',
                    panEnabled: true,
                    controlIconsEnabled: true, // Hiển thị nút zoom +/-
                    zoomEnabled: true,
                    dblClickZoomEnabled: true,
                    mouseWheelZoomEnabled: true,
                    fit: true,
                    center: true
                });
            });
            
            // Fallback nếu không tải được SVG (chạy demo)
            svgObject.onerror = function() {
                console.log("Không tải được SVG");
            }
        }

        // Chạy chương trình
        window.onload = () => {
            // Nếu bạn chưa có file, tôi dùng link online để demo
            // Bỏ comment 2 dòng dưới để test ngay mà không cần tạo file
            //CONFIG.svgPath = "https://dev.w3.org/SVG/tools/svgweb/samples/svg-files/410.svg"; 
            // CONFIG.mdPath = "https://raw.githubusercontent.com/wiki/adam-p/markdown-here/Markdown-Cheatsheet.md"; 

            loadMarkdown();
            loadSVG();
        };
    </script>
</body>
</html>
